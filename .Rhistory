)
View(enrichment_out)
enrichment_target_df <- read.delim("stats.txt", header = TRUE, stringsAsFactors = FALSE, sep = "\t")
View(enrichment_target_df)
enrichment_target_df = enrichment_target_df %>%
filter(Significant != 'non-significant' && significant != 'q-value < 0.05, -1 > FC < 1')
enrichment_target_df <- read.delim("stats.txt", header = TRUE, stringsAsFactors = FALSE, sep = "\t")
enrichment_target_df = enrichment_target_df %>%
filter(Significant != 'non-significant' && Significant != 'q-value < 0.05, -1 > FC < 1')
enrichment_target_df = enrichment_target_df %>%
filter(Significant != 'non-significant' && Significant != 'q-value < 0.05, -1 > FC < 1')
enrichment_target_df = enrichment_target_df %>%
filter(Significant != 'non-significant' & Significant != 'q-value < 0.05, -1 > FC < 1')
View(enrichment_target_df)
enrichment_target_df_down = list(enrichment_target_df %>%
filter(Significant == "Downregulated") %>%
select(Uniprot))
View(listsof)
enrichment_target_df_down = list(enrichment_target_df %>%
filter(Significant == "Downregulated") %>%
select(Uniprot))
enrichment_target_df_up = list(enrichment_target_df %>%
filter(Significant == "Upregulated") %>%
select(Uniprot))
View(enrichment_target_df_down)
enrichment_target_df_down = enrichment_target_df %>%
filter(Significant == "Downregulated") %>%
select(Uniprot)
View(enrichment_target_df_down)
enrichment_target_df_down = enrichment_target_df %>%
filter(Significant == "Downregulated")
enrichment_target_df <- read.delim("stats.txt", header = TRUE, stringsAsFactors = FALSE, sep = "\t")
enrichment_target_df_down = enrichment_target_df %>%
filter(Significant == "Downregulated")
View(enrichment_target_df_down)
View(enrichment_out)
enrichment_target_df_down = enrichment_target_df %>%
filter(Significant == "Downregulated")
enrichment_target_df_down = enrichment_target_df %>%
filter(Significant = "Downregulated")
View(enrichment_target_df)
enrichment_target_df_down = enrichment_target_df %>%
filter(Significant == "downregulated")
enrichment_target_df_down = enrichment_target_df %>%
filter(Significant == "downregulated") %>%
select(Uniprot)
enrichment_target_df_down = list(enrichment_target_df %>%
filter(Significant == "downregulated") %>%
select(Uniprot))
View(enrichment_target_df_down)
enrichment_target_df_down[[1]]
enrichment_target_df_down[[1]][["Uniprot"]]
enrichment_target_df_down = as.list(enrichment_target_df %>%
filter(Significant == "downregulated") %>%
select(Uniprot))
View(enrichment_target_df_down)
enrichment_target_df_down[["Uniprot"]]
#ORA FDR
enrichment_out <- WebGestaltR(enrichMethod = "ORA",
interestGene = enrichment_target_df_down[["Uniprot"]],
isOutput = FALSE,
interestGeneType = "uniprotswissprot",
enrichDatabase = "geneontology_Biological_Process",
organism = "hsapiens",
referenceSet = "genome_protein-coding",
projectName = "User",
sigMethod = "fdr",
fdrMethod = "BH",
fdrThr = 0.05
)#ORA top
enrichment_target_df_up = list(enrichment_target_df %>%
filter(Significant == "upregulated") %>%
select(Uniprot))
#ORA FDR
enrichment_out <- WebGestaltR(enrichMethod = "ORA",
interestGene = enrichment_target_df_down[["Uniprot"]],
isOutput = FALSE,
interestGeneType = "uniprotswissprot",
enrichDatabase = "geneontology_Biological_Process",
organism = "hsapiens",
referenceSet = "genome_protein-coding",
projectName = "User",
sigMethod = "fdr",
fdrMethod = "BH",
fdrThr = 0.05
)#ORA top
View(enrichment_target_df_up)
enrichment_target_df_up[[1]]
enrichment_target_df_up = enrichment_target_df %>%
filter(Significant == "upregulated") %>%
select(Uniprot)
View(enrichment_target_df_up)
#ORA FDR
enrichment_out <- WebGestaltR(enrichMethod = "ORA",
interestGene = enrichment_target_df_down[1],
isOutput = FALSE,
interestGeneType = "uniprotswissprot",
enrichDatabase = "geneontology_Biological_Process",
organism = "hsapiens",
referenceSet = "genome_protein-coding",
projectName = "User",
sigMethod = "fdr",
fdrMethod = "BH",
fdrThr = 0.05
)#ORA top
enrichment_target_list_up <- list(enrichment_target_df_up$Uniprot)
View(enrichment_target_list_up)
enrichment_target_list_up <- list(enrichment_target_df_up$Uniprot)
#ORA FDR
enrichment_out <- WebGestaltR(enrichMethod = "ORA",
interestGene = enrichment_target_df_down[[1]],
isOutput = FALSE,
interestGeneType = "uniprotswissprot",
enrichDatabase = "geneontology_Biological_Process",
organism = "hsapiens",
referenceSet = "genome_protein-coding",
projectName = "User",
sigMethod = "fdr",
fdrMethod = "BH",
fdrThr = 0.05
)#ORA top
#ORA FDR
enrichment_out <- WebGestaltR(enrichMethod = "ORA",
interestGene = enrichment_target_df_down[[1]],
isOutput = FALSE,
interestGeneType = "uniprotswissprot",
enrichDatabase = "geneontology_Biological_Process",
organism = "hsapiens",
referenceSet = "genome_protein-coding"
)#ORA top
#ORA FDR
enrichment_out <- WebGestaltR(enrichMethod = "ORA",
interestGene = enrichment_target_list_up[[1]],
isOutput = FALSE,
interestGeneType = "uniprotswissprot",
enrichDatabase = "geneontology_Biological_Process",
organism = "hsapiens",
referenceSet = "genome_protein-coding",
projectName = "User",
sigMethod = "fdr",
fdrMethod = "BH",
fdrThr = 0.05
)#ORA top
enrichment_target_df_up = list(enrichment_target_df %>%
filter(Significant == "upregulated") %>%
select(Uniprot))
View(enrichment_target_df_up)
View(enrichment_target_df_up[[1]])
enrichment_target_df_up[[1]]
#ORA FDR
enrichment_out <- WebGestaltR(enrichMethod = "ORA",
interestGene = enrichment_target_df_up[[1]],
isOutput = FALSE,
interestGeneType = "uniprotswissprot",
enrichDatabase = "geneontology_Biological_Process",
organism = "hsapiens",
referenceSet = "genome_protein-coding",
projectName = "User",
sigMethod = "fdr",
fdrMethod = "BH",
fdrThr = 0.05
)#ORA top
View(enrichment_target_df_up)
enrichment_target_list_up <- lapply(enrichment_target_df_up, function(x){
return(x)
})
View(listsof)
enrichment_target_list_up <- lapply(enrichment_target_df_up, function(x){
x
})
enrichment_target_list_up <- lapply(enrichment_target_df_up, function(x){
print(x)
})
enrichment_target_list_up <- lapply(enrichment_target_df_up, function(x){
print(x[1])
})
enrichment_target_list_up <- lapply(enrichment_target_df_up, function(x){
print(x[1,])
})
enrichment_target_list_up <- lapply(1:len(enrichment_target_df_up), function(x){
print(enrichment_target_df_up[x,])
})
enrichment_target_list_up <- lapply(1:length(enrichment_target_df_up), function(x){
print(enrichment_target_df_up[x,])
})
enrichment_target_list_up <- lapply(1:length(rownames(enrichment_target_df_up)), function(x){
print(enrichment_target_df_up[x,])
})
enrichment_target_list_up <- lapply(1:length(rownames(enrichment_target_df_up)), function(x){
print(enrichment_target_df_up[x,])
})
enrichment_target_list_up <- lapply(rownames(enrichment_target_df_up)), function(x){
print(x)
})
enrichment_target_list_up <- lapply(rownames(enrichment_target_df_up)), function(x){
print(x)
})
enrichment_target_list_up <- lapply(rownames(enrichment_target_df_up), function(x){
print(x)
})
lapply(rownames(enrichment_target_df_up), function(x){
print(x)
})
lapply(enrichment_target_df_up, function(x){
print(x)
})
enrichment_target_df_up = enrichment_target_df %>%
filter(Significant == "upregulated") %>%
select(Uniprot)
lapply(enrichment_target_df_up, function(x){
print(x)
})
lapply(1:lenght(enrichment_target_df_up), function(x){
print(x)
})
lapply(1:length(enrichment_target_df_up), function(x){
print(x)
})
lapply(1:length(rownames(enrichment_target_df_up)), function(x){
print(x)
})
lapply(rownames(enrichment_target_df_up), function(x){
print(x)
})
lapply(rownames(enrichment_target_df_up), function(x){
print(x)
})
#ORA FDR
enrichment_out <- WebGestaltR(enrichMethod = "ORA",
interestGene = enrichment_target_df_up[[1]],
isOutput = FALSE,
interestGeneType = "uniprotswissprot",
enrichDatabase = "geneontology_Biological_Process",
organism = "hsapiens",
referenceSet = "genome_protein-coding",
projectName = "User",
sigMethod = "fdr",
fdrMethod = "BH",
fdrThr = 0.05
)#ORA top
lapply(rownames(enrichment_target_df_up), function(x){
print(x)
})
View(enrichment_target_df_up)
lapply(length(enrichment_target_df_up), function(x){
print(x)
})
lapply(length(rownames(enrichment_target_df_up)), function(x){
print(x)
})
lapply(1:length(rownames(enrichment_target_df_up)), function(x){
print(x)
})
lapply(1:length(rownames(enrichment_target_df_up)), function(x){
print(enrichment_target_df_up[x,])
})
enrichment_target_listf_up <- lapply(1:length(rownames(enrichment_target_df_up)), function(x){
return(enrichment_target_df_up[x,])
})
remove(enrichment_out)
remove(enrichment_target_df)
remove(enrichment_target_df_down)
remove(enrichment_target_df_up)
remove(enrichment_target_list_up)
remove(enrichment_target_listf_up)
enrichment_target_df <- read.delim("stats.txt", header = TRUE, stringsAsFactors = FALSE, sep = "\t")
enrichment_target_df_up = enrichment_target_df %>%
filter(Significant == "upregulated") %>%
select(Uniprot)
enrichment_target_listf_up <- lapply(1:length(rownames(enrichment_target_df_up)), function(x){
return(enrichment_target_df_up[x,])
})
#ORA FDR
enrichment_out <- WebGestaltR(enrichMethod = "ORA",
interestGene = enrichment_target_listf_up,
isOutput = FALSE,
interestGeneType = "uniprotswissprot",
enrichDatabase = "geneontology_Biological_Process",
organism = "hsapiens",
referenceSet = "genome_protein-coding",
projectName = "User",
sigMethod = "fdr",
fdrMethod = "BH",
fdrThr = 0.05
)#ORA top
View(enrichment_out)
#ORA FDR
enrichment_out <- WebGestaltR(enrichMethod = "ORA",
interestGene = enrichment_target_listf_up,
interestGeneType = "uniprotswissprot",
enrichDatabase = "geneontology_Biological_Process",
organism = "hsapiens",
referenceSet = "genome_protein-coding",
projectName = "User",
sigMethod = "fdr",
fdrMethod = "BH",
fdrThr = 0.05
)#ORA top
#ORA FDR
enrichment_out <- WebGestaltR(enrichMethod = "ORA",
interestGene = enrichment_target_listf_up,
interestGeneType = "uniprotswissprot",
enrichDatabase = "geneontology_Biological_Process",
organism = "hsapiens",
referenceSet = "genome_protein-coding",
projectName = "User",
sigMethod = "fdr",
fdrMethod = "BH",
fdrThr = 0.05
)#ORA top
enrichment_target_df_down = enrichment_target_df %>%
filter(Significant == "downregulated") %>%
select(Uniprot)
enrichment_target_listf_down <- lapply(1:length(rownames(enrichment_target_df_down)), function(x){
return(enrichment_target_df_down[x,])
})
#ORA FDR
enrichment_out <- WebGestaltR(enrichMethod = "ORA",
interestGene = enrichment_target_listf_up,
isOutput = FALSE,
interestGeneType = "uniprotswissprot",
enrichDatabase = "geneontology_Biological_Process",
organism = "hsapiens",
referenceSet = "genome_protein-coding",
projectName = "User",
sigMethod = "fdr",
fdrMethod = "BH",
fdrThr = 0.05
)#ORA top
View(enrichment_out)
#ORA FDR
enrichment_out <- WebGestaltR(enrichMethod = "ORA",
interestGene = enrichment_target_listf_down,
isOutput = FALSE,
interestGeneType = "uniprotswissprot",
enrichDatabase = "geneontology_Biological_Process",
organism = "hsapiens",
referenceSet = "genome_protein-coding",
projectName = "User",
sigMethod = "fdr",
fdrMethod = "BH",
fdrThr = 0.05
)#ORA top
runApp()
enrichment_target_df <- read.delim("stats.txt", header = TRUE, stringsAsFactors = FALSE, sep = "\t")
enrichment_target_df_down = enrichment_target_df %>%
filter(Significant == "downregulated") %>%
select(Uniprot)
enrichment_target_df_up = enrichment_target_df %>%
filter(Significant == "upregulated") %>%
select(Uniprot)
enrichment_target_listf_up <- lapply(1:length(rownames(enrichment_target_df_up)), function(x){
return(enrichment_target_df_up[x,])
})
enrichment_target_listf_down <- lapply(1:length(rownames(enrichment_target_df_down)), function(x){
return(enrichment_target_df_down[x,])
})
#ORA FDR
enrichment_out <- WebGestaltR(enrichMethod = "ORA",
interestGene = enrichment_target_listf_down,
isOutput = FALSE,
interestGeneType = "uniprotswissprot",
enrichDatabase = "geneontology_Biological_Process",
organism = "hsapiens",
referenceSet = "genome_protein-coding",
projectName = "User",
sigMethod = "fdr",
fdrMethod = "BH",
fdrThr = 0.05
)
#ORA FDR
enrichment_out <- WebGestaltR(enrichMethod = "ORA",
interestGene = enrichment_target_listf_up,
isOutput = FALSE,
interestGeneType = "uniprotswissprot",
enrichDatabase = "geneontology_Biological_Process",
organism = "hsapiens",
referenceSet = "genome_protein-coding",
projectName = "User",
sigMethod = "fdr",
fdrMethod = "BH",
fdrThr = 0.05
)
View(enrichment_out)
enrichment_out$enrichmentRatio <- enrichment_out$enrichmentRatio * - 1
View(enrichment_out)
enrichment_out_up <- WebGestaltR(enrichMethod = "ORA",
interestGene = enrichment_target_listf_up,
isOutput = FALSE,
interestGeneType = "uniprotswissprot",
enrichDatabase = "geneontology_Biological_Process",
organism = "hsapiens",
referenceSet = "genome_protein-coding",
projectName = "User",
sigMethod = "fdr",
fdrMethod = "BH",
fdrThr = 0.05
)
enrichment_out_down <- WebGestaltR(enrichMethod = "ORA",
interestGene = enrichment_target_listf_down,
isOutput = FALSE,
interestGeneType = "uniprotswissprot",
enrichDatabase = "geneontology_Biological_Process",
organism = "hsapiens",
referenceSet = "genome_protein-coding",
projectName = "User",
sigMethod = "fdr",
fdrMethod = "BH",
fdrThr = 0.05
)
enrichment_out_down$enrichmentRatio <- enrichment_out_down$enrichmentRatio * - 1
View(enrichment_out_down)
enrichment_df_ora <- rbind(enrichment_out_down, enrichment_out_up)
View(enrichment_df_ora)
enrichment_out_down <- WebGestaltR(enrichMethod = "ORA",
interestGene = enrichment_target_listf_down,
isOutput = FALSE,
interestGeneType = "uniprotswissprot",
enrichDatabase = "geneontology_Biological_Process",
organism = "hsapiens",
referenceSet = "genome_protein-coding",
projectName = "User",
sigMethod = "fdr",
fdrMethod = "BH",
fdrThr = 0.05
)
View(enrichment_target_df_down)
enrichment_target_df <- read.delim("stats.txt", header = TRUE, stringsAsFactors = FALSE, sep = "\t")
enrichment_target_df_down = enrichment_target_df %>%
filter(Significant == "downregulated") %>%
select(Uniprot)
enrichment_target_df_up = enrichment_target_df %>%
filter(Significant == "upregulated") %>%
select(Uniprot)
enrichment_target_listf_up <- lapply(1:length(rownames(enrichment_target_df_up)), function(x){
return(enrichment_target_df_up[x,])
})
enrichment_target_listf_down <- lapply(1:length(rownames(enrichment_target_df_down)), function(x){
return(enrichment_target_df_down[x,])
})
#ORA FDR
enrichment_out_up <- WebGestaltR(enrichMethod = "ORA",
interestGene = enrichment_target_listf_up,
isOutput = FALSE,
interestGeneType = "uniprotswissprot",
enrichDatabase = "geneontology_Biological_Process",
organism = "hsapiens",
referenceSet = "genome_protein-coding",
projectName = "User",
sigMethod = "fdr",
fdrMethod = "BH",
fdrThr = 0.05
)
enrichment_out_down <- WebGestaltR(enrichMethod = "ORA",
interestGene = enrichment_target_listf_down,
isOutput = FALSE,
interestGeneType = "uniprotswissprot",
enrichDatabase = "geneontology_Biological_Process",
organism = "hsapiens",
referenceSet = "genome_protein-coding",
projectName = "User",
sigMethod = "fdr",
fdrMethod = "BH",
fdrThr = 0.05
)
View(enrichment_target_df_up)
View(enrichment_out_up)
if (!is.null(enrichment_out_up)) {
enrichment_out_up = enrichment_out_up %>%
arrange(desc(fdr))
}
View(enrichment_out_up)
enrichment_out_up = enrichment_out_up %>%
arrange(desc(FDR))
View(enrichment_out_up)
enrichment_out_up = enrichment_out_up %>%
arrange(FDR)
if (!is.null(enrichment_out_up)) {
enrichment_out_up = enrichment_out_up %>%
arrange(desc(enrichmentRatio)) %>%
top_n(10)
}
View(enrichment_out_up)
#ORA FDR
enrichment_out_up <- WebGestaltR(enrichMethod = "ORA",
interestGene = enrichment_target_listf_up,
isOutput = FALSE,
interestGeneType = "uniprotswissprot",
enrichDatabase = "geneontology_Biological_Process",
organism = "hsapiens",
referenceSet = "genome_protein-coding",
projectName = "User",
sigMethod = "fdr",
fdrMethod = "BH",
fdrThr = 0.05
)
if (!is.null(enrichment_out_up)) {
enrichment_out_up = enrichment_out_up %>%
arrange(desc(enrichmentRatio)) %>%
top_n(300)
}
View(enrichment_out_up)
View(enrichment_out_up)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
